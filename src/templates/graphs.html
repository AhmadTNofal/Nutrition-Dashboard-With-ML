<!DOCTYPE html>
<html class="{{ dark_mode }}">

  <head>
    <title>Graphs</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/Main.css') }}" />
  </head>
  
  <body>
    <script src="main.js"></script>
    <div class="app-container">
      <div class="app-header">
        <div class="app-header-left">
          <span class="app-icon"></span>
          <p class="app-name">DASHBOARD</p>
        </div>
        <div class="app-header-right">
          <button class="mode-switch" title="Switch Theme">
            <svg
              class="moon"
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              width="24"
              height="24"
              viewBox="0 0 24 24"
            >
              <defs></defs>
              <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
            </svg>
          </button>
        </div>
      </div>
      <div class="app-content">
        <div class="app-sidebar">
          <a href="index.html" class="app-sidebar-link">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="feather feather-home"
            >
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
              <polyline points="9 22 9 12 15 12 15 22" />
            </svg>
          </a>
          <a href="graphs.html" class="app-sidebar-link active">
            <svg
              class="link-icon"
              width="24"
              height="24"
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              class="feather feather-pie-chart"
              viewBox="0 0 24 24"
            >
              <defs />
              <path
                d="M21.21 15.89A10 10 0 118 2.83M22 12A10 10 0 0012 2v10z"
              />
            </svg>
          </a>

        </div>
        <div class="projects-section">
          <div class="projects-section-header">
            <p>GRAPHS</p>
            <p> Current Patients: {{ sum }} </p>
            <p> Need Referral: {{ count }} </p>
            <p class="time">{{ today }}</p>
          </div>
          <div class="projects-section-line">
            <div class="projects-status">

            
              <div class="graph-container pie-chart-container">
                <canvas id="pieChart"></canvas>
              </div>
            </div>

              <div class="graph-container histogram-container">
                <canvas id="histogram"></canvas>
              </div>

          </div>
        </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
          var pieData = JSON.parse('{{ pie_data | safe }}');
          var histogramData = JSON.parse('{{ histogram_data | safe }}');
      
          var ctxPie = document.getElementById('pieChart').getContext('2d');
          var pieChart = new Chart(ctxPie, {
              type: 'pie',
              data: {
                  labels: ['Needs Referral', 'No Referral'],
                  datasets: [{
                      data: pieData,
                      backgroundColor: ['red', 'green'],
                  }]
              }
          });
      
          var ctxHistogram = document.getElementById('histogram').getContext('2d');
          var histogramChart = new Chart(ctxHistogram, {
              type: 'bar',
              data: {
                  labels: histogramData.map((_, i) => `Patient ${i + 1}`),
                  datasets: [{
                      label: 'Confidence Score (%)',
                      data: histogramData,
                      backgroundColor: 'blue',
                  }]
              },
              options: {
                  scales: {
                      y: {
                          beginAtZero: true,
                          responsive: true,
                          maintainAspectRatio: false
                      }
                  }
              }
          });
      });
      </script>      
  </body>
</html>
